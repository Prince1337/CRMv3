import{d as R}from"./chunk-ASJLSJFH.js";import"./chunk-562UQ2XR.js";import{b as K,d as L,h as B}from"./chunk-BYEZXU77.js";import{$a as s,G as E,Ia as p,Jb as V,Ka as l,Kb as z,Ma as S,Na as r,Nb as A,Oa as n,Pa as k,Qa as w,R as C,Ra as M,Sa as h,Ta as g,Ua as a,W as D,Ya as T,Za as i,_a as x,ab as b,ca as u,da as _,gb as P,j as v,jb as O,kb as F,mb as N,ra as y,v as I,va as o}from"./chunk-ZEIBLRTY.js";import"./chunk-CWTPBX7D.js";function j(t,c){if(t&1&&(r(0,"p")(1,"strong"),i(2,"Telefon:"),n(),i(3),n()),t&2){let e=a().ngIf;o(3),s(" ",e.phone,"")}}function $(t,c){if(t&1&&(r(0,"p")(1,"strong"),i(2,"Mobil:"),n(),i(3),n()),t&2){let e=a().ngIf;o(3),s(" ",e.mobile,"")}}function U(t,c){if(t&1&&(r(0,"p")(1,"strong"),i(2,"Website:"),n(),r(3,"a",14),i(4),n()()),t&2){let e=a().ngIf;o(3),l("href",e.website,y),o(),x(e.website)}}function W(t,c){if(t&1&&(r(0,"p")(1,"strong"),i(2,"Firma:"),n(),i(3),n()),t&2){let e=a().ngIf;o(3),s(" ",e.companyName,"")}}function Z(t,c){if(t&1&&(r(0,"p")(1,"strong"),i(2,"Position:"),n(),i(3),n()),t&2){let e=a().ngIf;o(3),s(" ",e.position,"")}}function Q(t,c){if(t&1&&(r(0,"p")(1,"strong"),i(2,"Abteilung:"),n(),i(3),n()),t&2){let e=a().ngIf;o(3),s(" ",e.department,"")}}function q(t,c){if(t&1&&(r(0,"p"),i(1),n()),t&2){let e=a().ngIf;o(),x(e.fullAddress)}}function G(t,c){if(t&1&&(r(0,"p"),i(1),n()),t&2){let e=a(2).ngIf;o(),b("",e.street," ",e.houseNumber,"")}}function H(t,c){if(t&1&&(r(0,"p"),i(1),n()),t&2){let e=a(2).ngIf;o(),b("",e.postalCode," ",e.city,"")}}function J(t,c){if(t&1&&(r(0,"p"),i(1),n()),t&2){let e=a(2).ngIf;o(),x(e.country)}}function X(t,c){if(t&1&&(w(0),p(1,G,2,2,"p",9)(2,H,2,2,"p",9)(3,J,2,1,"p",9),M()),t&2){let e=a().ngIf;o(),l("ngIf",e.street||e.houseNumber),o(),l("ngIf",e.postalCode||e.city),o(),l("ngIf",e.country)}}function Y(t,c){if(t&1&&(r(0,"p")(1,"strong"),i(2,"Quelle:"),n(),i(3),n()),t&2){let e=a().ngIf;o(3),s(" ",e.source,"")}}function ee(t,c){if(t&1&&(r(0,"p")(1,"strong"),i(2,"Tags:"),n(),i(3),n()),t&2){let e=a().ngIf;o(3),s(" ",e.tags,"")}}function te(t,c){if(t&1&&(r(0,"p")(1,"strong"),i(2,"Notizen:"),n(),i(3),n()),t&2){let e=a().ngIf;o(3),s(" ",e.notes,"")}}function ne(t,c){if(t&1&&(r(0,"p")(1,"strong"),i(2,"Interne Notizen:"),n(),i(3),n()),t&2){let e=a().ngIf;o(3),s(" ",e.internalNotes,"")}}function ie(t,c){if(t&1&&(r(0,"p")(1,"strong"),i(2,"Letzter Kontakt:"),n(),i(3),n()),t&2){let e=a().ngIf,m=a();o(3),s(" ",m.customerService.formatDate(e.lastContact),"")}}function oe(t,c){if(t&1&&(r(0,"p")(1,"strong"),i(2,"Zugewiesen an:"),n(),i(3),n()),t&2){let e=a().ngIf;o(3),s(" ",e.assignedToFullName,"")}}function re(t,c){if(t&1){let e=h();r(0,"div",3)(1,"button",4),g("click",function(){u(e);let d=a();return _(d.goBack())}),i(2,"\u2190 Zur\xFCck zur Liste"),n(),r(3,"div",5)(4,"h1"),i(5),n(),r(6,"span",6),i(7),n()(),r(8,"div",7)(9,"div",8)(10,"h2"),i(11,"Kontaktdaten"),n(),r(12,"p")(13,"strong"),i(14,"E-Mail:"),n(),i(15),n(),p(16,j,4,1,"p",9)(17,$,4,1,"p",9)(18,U,5,2,"p",9),n(),r(19,"div",8)(20,"h2"),i(21,"Firma & Position"),n(),p(22,W,4,1,"p",9)(23,Z,4,1,"p",9)(24,Q,4,1,"p",9),n(),r(25,"div",8)(26,"h2"),i(27,"Adresse"),n(),p(28,q,2,1,"p",9)(29,X,4,3,"ng-container",9),n(),r(30,"div",8)(31,"h2"),i(32,"Weitere Informationen"),n(),p(33,Y,4,1,"p",9)(34,ee,4,1,"p",9)(35,te,4,1,"p",9)(36,ne,4,1,"p",9),n(),r(37,"div",10)(38,"p")(39,"strong"),i(40,"Erstellt am:"),n(),i(41),n(),r(42,"p")(43,"strong"),i(44,"Letzte \xC4nderung:"),n(),i(45),n(),p(46,ie,4,1,"p",9),r(47,"p")(48,"strong"),i(49,"Erstellt von:"),n(),i(50),n(),p(51,oe,4,1,"p",9),n()(),r(52,"div",11)(53,"button",12),g("click",function(){let d=u(e).ngIf,f=a();return _(f.editCustomer(d.id))}),i(54,"Bearbeiten"),n(),r(55,"button",13),g("click",function(){let d=u(e).ngIf,f=a();return _(f.confirmDelete(d))}),i(56,"L\xF6schen"),n()()()}if(t&2){let e=c.ngIf,m=a();o(5),x(e.fullName),o(),S(m.customerService.getStatusClass(e.status)),o(),s(" ",e.statusDisplayName," "),o(8),s(" ",e.email,""),o(),l("ngIf",e.phone),o(),l("ngIf",e.mobile),o(),l("ngIf",e.website),o(4),l("ngIf",e.companyName),o(),l("ngIf",e.position),o(),l("ngIf",e.department),o(4),l("ngIf",e.fullAddress),o(),l("ngIf",!e.fullAddress),o(4),l("ngIf",e.source),o(),l("ngIf",e.tags),o(),l("ngIf",e.notes),o(),l("ngIf",e.internalNotes),o(5),s(" ",m.customerService.formatDate(e.createdAt),""),o(4),s(" ",m.customerService.formatDate(e.updatedAt),""),o(),l("ngIf",e.lastContact),o(4),s(" ",e.createdByFullName,""),o(),l("ngIf",e.assignedToFullName)}}function ae(t,c){if(t&1){let e=h();r(0,"div",15),g("click",function(){u(e);let d=a();return _(d.cancelDelete())}),r(1,"div",16),g("click",function(d){return u(e),_(d.stopPropagation())}),r(2,"h3"),i(3,"Kunde l\xF6schen"),n(),r(4,"p"),i(5,"M\xF6chten Sie den Kunden "),r(6,"strong"),i(7),n(),i(8," wirklich l\xF6schen?"),n(),r(9,"p",17),i(10,"Diese Aktion kann nicht r\xFCckg\xE4ngig gemacht werden."),n(),r(11,"div",18)(12,"button",19),g("click",function(){u(e);let d=a();return _(d.cancelDelete())}),i(13,"Abbrechen"),n(),r(14,"button",20),g("click",function(){u(e);let d=a();return _(d.deleteCustomer())}),i(15),n()()()()}if(t&2){let e=a();o(7),x(e.customerToDelete==null?null:e.customerToDelete.fullName),o(7),l("disabled",e.deleting),o(),s(" ",e.deleting?"L\xF6sche...":"L\xF6schen"," ")}}function le(t,c){t&1&&(r(0,"div",23),k(1,"div",24),r(2,"p"),i(3,"Lade Kundendaten..."),n()())}function ce(t,c){if(t&1&&(r(0,"div",25),i(1),n()),t&2){let e=a(2);o(),s(" ",e.error," ")}}function me(t,c){if(t&1&&p(0,le,4,0,"div",21)(1,ce,2,1,"div",22),t&2){let e=a();l("ngIf",e.loading),o(),l("ngIf",e.error)}}var ve=(()=>{class t{constructor(){this.customerService=C(R),this.route=C(K),this.router=C(L),this.loading=!0,this.error="",this.showDeleteConfirm=!1,this.customerToDelete=null,this.deleting=!1}ngOnInit(){this.customer$=this.route.paramMap.pipe(E(e=>{let m=Number(e.get("id"));return m?(this.loading=!0,this.error="",this.customerService.getCustomer(m).pipe(I(d=>(this.error="Kunde konnte nicht geladen werden.",this.loading=!1,v(null))))):(this.error="Ung\xFCltige Kunden-ID.",this.loading=!1,v(null))})),this.customer$.subscribe(()=>this.loading=!1)}editCustomer(e){this.router.navigate(["/customers",e,"edit"])}goBack(){this.router.navigate(["/customers"])}confirmDelete(e){this.customerToDelete=e,this.showDeleteConfirm=!0}cancelDelete(){this.showDeleteConfirm=!1,this.customerToDelete=null,this.deleting=!1}deleteCustomer(){this.customerToDelete&&(this.deleting=!0,this.customerService.deleteCustomer(this.customerToDelete.id).subscribe({next:()=>{this.deleting=!1,this.showDeleteConfirm=!1,this.customerToDelete=null,this.router.navigate(["/customers"])},error:e=>{this.deleting=!1,console.error("Fehler beim L\xF6schen des Kunden:",e),alert("Fehler beim L\xF6schen des Kunden. Bitte versuchen Sie es erneut.")}}))}static{this.\u0275fac=function(m){return new(m||t)}}static{this.\u0275cmp=D({type:t,selectors:[["app-customer-detail"]],standalone:!0,features:[P],decls:5,vars:5,consts:[["loadingOrError",""],["class","customer-detail-container",4,"ngIf","ngIfElse"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"customer-detail-container"],[1,"btn-secondary","back-btn",3,"click"],[1,"detail-header"],[1,"status-badge"],[1,"detail-content"],[1,"detail-section"],[4,"ngIf"],[1,"detail-section","meta"],[1,"actions"],[1,"btn-primary",3,"click"],[1,"btn-danger",3,"click"],["target","_blank",3,"href"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"warning-text"],[1,"modal-actions"],[1,"btn-secondary",3,"click"],[1,"btn-danger",3,"click","disabled"],["class","loading",4,"ngIf"],["class","error-message",4,"ngIf"],[1,"loading"],[1,"spinner"],[1,"error-message"]],template:function(m,d){if(m&1&&(p(0,re,57,22,"div",1),O(1,"async"),p(2,ae,16,3,"div",2)(3,me,2,2,"ng-template",null,0,N)),m&2){let f=T(4);l("ngIf",F(1,3,d.customer$))("ngIfElse",f),o(2),l("ngIf",d.showDeleteConfirm)}},dependencies:[A,V,z,B],styles:[".customer-detail-container[_ngcontent-%COMP%]{max-width:700px;margin:2rem auto;background:#fff;border-radius:8px;box-shadow:0 2px 8px #00000012;padding:2rem 2.5rem 1.5rem;position:relative}.back-btn[_ngcontent-%COMP%]{font-size:1rem;background:none;border:none;color:#007bff;cursor:pointer;padding:0;margin-bottom:1rem}.detail-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1.5rem;margin-bottom:1.5rem}.detail-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:2rem;flex:1}.status-badge[_ngcontent-%COMP%]{padding:.3em 1em;border-radius:1em;font-size:1rem;font-weight:500;display:inline-block}.detail-content[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:2rem;margin-bottom:2rem}.detail-section[_ngcontent-%COMP%]{flex:1 1 250px;min-width:220px;margin-bottom:1rem}.detail-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.1rem;margin-bottom:.5rem;color:#555}.meta[_ngcontent-%COMP%]{font-size:.95em;color:#888}.actions[_ngcontent-%COMP%]{text-align:right}.btn-primary[_ngcontent-%COMP%]{background:#007bff;color:#fff;border:none;border-radius:4px;padding:.5em 1.5em;font-size:1rem;cursor:pointer;margin-left:.5em}.btn-primary[_ngcontent-%COMP%]:hover{background:#0056b3}.btn-danger[_ngcontent-%COMP%]{background:#dc3545;color:#fff;border:none;border-radius:4px;padding:.5em 1.5em;font-size:1rem;cursor:pointer;margin-left:.5em}.btn-danger[_ngcontent-%COMP%]:hover{background:#c82333}.btn-danger[_ngcontent-%COMP%]:disabled{background:#6c757d;cursor:not-allowed}.loading[_ngcontent-%COMP%]{text-align:center;margin:3rem 0}.spinner[_ngcontent-%COMP%]{border:4px solid #f3f3f3;border-top:4px solid #007bff;border-radius:50%;width:36px;height:36px;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 1rem}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.error-message[_ngcontent-%COMP%]{color:#b00020;background:#ffeaea;border:1px solid #ffb3b3;padding:1em;border-radius:4px;margin:2rem auto;max-width:400px;text-align:center}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000}.modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:2rem;max-width:500px;width:90%;box-shadow:0 4px 20px #00000026}.modal-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1rem;color:#333}.modal-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 1rem;color:#666}.warning-text[_ngcontent-%COMP%]{color:#dc3545;font-weight:500;background:#ffeaea;padding:.5rem;border-radius:4px;border-left:4px solid #dc3545}.modal-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;justify-content:flex-end;margin-top:1.5rem}.btn-secondary[_ngcontent-%COMP%]{background:#6c757d;color:#fff;border:none;border-radius:4px;padding:.5em 1.5em;font-size:1rem;cursor:pointer}.btn-secondary[_ngcontent-%COMP%]:hover{background:#5a6268}@media (max-width: 700px){.customer-detail-container[_ngcontent-%COMP%]{padding:1rem .5rem}.detail-content[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}.modal-content[_ngcontent-%COMP%]{margin:1rem;padding:1.5rem}.modal-actions[_ngcontent-%COMP%]{flex-direction:column}}"]})}}return t})();export{ve as CustomerDetailComponent};
