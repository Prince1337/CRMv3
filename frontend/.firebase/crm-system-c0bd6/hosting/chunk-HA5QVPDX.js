import{a as z}from"./chunk-562UQ2XR.js";import{$a as g,A as p,Ia as v,Ib as M,Jb as w,Ka as c,L as x,Na as t,Nb as I,Oa as n,Q as h,Sa as E,Ta as P,Tb as y,Ua as l,W as S,Za as i,_a as s,ca as _,da as C,gb as O,j as u,v as f,va as r,wa as b}from"./chunk-ZEIBLRTY.js";import"./chunk-CWTPBX7D.js";var k=(()=>{class a{constructor(e){this.http=e,this.API_URL=`${z.API_BASE_URL}/statistics`}getStatistics(){return this.http.get(this.API_URL)}formatCurrency(e){return e==null?"0,00 \u20AC":new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(e)}formatPercentage(e){return e==null?"0%":`${e.toFixed(1)}%`}formatNumber(e){return e==null?"0":new Intl.NumberFormat("de-DE").format(e)}static{this.\u0275fac=function(o){return new(o||a)(h(y))}}static{this.\u0275prov=x({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();function R(a,d){a&1&&(t(0,"div",6)(1,"div",7)(2,"span",8),i(3,"Lade Statistiken..."),n()(),t(4,"p",9),i(5,"Lade Statistiken..."),n()())}function N(a,d){if(a&1){let e=E();t(0,"div",10)(1,"h4",11),i(2,"Fehler beim Laden der Statistiken"),n(),t(3,"p"),i(4),n(),t(5,"button",12),P("click",function(){_(e);let m=l();return C(m.loadStatistics())}),i(6," Erneut versuchen "),n()()}if(a&2){let e=l();r(4),s(e.error)}}function A(a,d){if(a&1&&(t(0,"div",35)(1,"h4"),i(2),n(),t(3,"div",36),i(4),n(),t(5,"div",37)(6,"span",38),i(7),n(),t(8,"span",39),i(9),n()()()),a&2){let e=d.$implicit,o=l(2);r(2),s(o.formatMonth(e.month)),r(2),s(o.formatCurrency(e.revenue)),r(3),g("+",e.wonLeads,""),r(2),g("-",e.lostLeads,"")}}function K(a,d){if(a&1&&(t(0,"div",40)(1,"h4"),i(2),n(),t(3,"div",41),i(4),n()()),a&2){let e=d.$implicit,o=l(2);r(2),s(e.name),r(2),s(o.formatPercentage(e.rate))}}function D(a,d){if(a&1&&(t(0,"div",42)(1,"h4"),i(2),n(),t(3,"div",43),i(4),n()()),a&2){let e=d.$implicit,o=l(2);r(2),s(e.name),r(2),s(o.formatPercentage(e.rate))}}function T(a,d){if(a&1&&(t(0,"div",13)(1,"section",14)(2,"h2"),i(3,"\xDCbersicht"),n(),t(4,"div",15)(5,"div",16)(6,"h3"),i(7,"Gesamtkunden"),n(),t(8,"div",17),i(9),n(),t(10,"div",18),i(11,"Alle Kunden in der Datenbank"),n()(),t(12,"div",16)(13,"h3"),i(14,"Offene Leads"),n(),t(15,"div",17),i(16),n(),t(17,"div",18),i(18,"Leads in der Pipeline"),n()(),t(19,"div",16)(20,"h3"),i(21,"Offene Aufgaben"),n(),t(22,"div",17),i(23),n(),t(24,"div",18),i(25,"Noch zu erledigende Aufgaben"),n()(),t(26,"div",16)(27,"h3"),i(28,"Aktive Kunden"),n(),t(29,"div",17),i(30),n(),t(31,"div",18),i(32,'Kunden mit Status "Aktiv"'),n()(),t(33,"div",16)(34,"h3"),i(35,"Potenziell"),n(),t(36,"div",17),i(37),n(),t(38,"div",18),i(39,'Kunden mit Status "Potenziell"'),n()(),t(40,"div",16)(41,"h3"),i(42,"Inaktiv"),n(),t(43,"div",17),i(44),n(),t(45,"div",18),i(46,'Kunden mit Status "Inaktiv"'),n()()()(),t(47,"section",19)(48,"h2"),i(49,"Umsatz & Leads"),n(),t(50,"div",20)(51,"div",21)(52,"h3"),i(53,"Gesamtumsatz"),n(),t(54,"div",17),i(55),n(),t(56,"div",18),i(57,"Gesamter Umsatz aus bezahlten Rechnungen"),n()(),t(58,"div",21)(59,"h3"),i(60,"Monatlicher Umsatz"),n(),t(61,"div",17),i(62),n(),t(63,"div",18),i(64,"Umsatz im aktuellen Monat"),n()(),t(65,"div",21)(66,"h3"),i(67,"Gewonnene Leads"),n(),t(68,"div",22),i(69),n(),t(70,"div",18),i(71,"Erfolgreich gewonnene Leads"),n()(),t(72,"div",21)(73,"h3"),i(74,"Verlorene Leads"),n(),t(75,"div",23),i(76),n(),t(77,"div",18),i(78,"Verlorene Leads"),n()(),t(79,"div",21)(80,"h3"),i(81,"Konversionsrate"),n(),t(82,"div",17),i(83),n(),t(84,"div",18),i(85,"Rate gewonnener vs. verlorener Leads"),n()(),t(86,"div",21)(87,"h3"),i(88,"Gewonnener Umsatz"),n(),t(89,"div",22),i(90),n(),t(91,"div",18),i(92,"Umsatz aus gewonnenen Leads"),n()()(),t(93,"div",24)(94,"h3"),i(95,"Umsatz nach Monat"),n(),t(96,"div",25),v(97,A,10,4,"div",26),n()()(),t(98,"section",27)(99,"h2"),i(100,"Konversionsraten"),n(),t(101,"div",28)(102,"div",29)(103,"h3"),i(104,"Lead zu Kunde"),n(),t(105,"div",17),i(106),n(),t(107,"div",18),i(108,"Rate der Leads die zu Kunden werden"),n()(),t(109,"div",29)(110,"h3"),i(111,"Angebot zu Gewonnen"),n(),t(112,"div",17),i(113),n(),t(114,"div",18),i(115,"Rate der Angebote die gewonnen werden"),n()(),t(116,"div",29)(117,"h3"),i(118,"Gesamtkonversion"),n(),t(119,"div",17),i(120),n(),t(121,"div",18),i(122,"Gesamte Konversionsrate"),n()()(),t(123,"div",30)(124,"h3"),i(125,"Konversion nach Quelle"),n(),t(126,"div",31),v(127,K,5,2,"div",32),n()(),t(128,"div",30)(129,"h3"),i(130,"Konversion nach Status"),n(),t(131,"div",33),v(132,D,5,2,"div",34),n()()()()),a&2){let e=l();r(9),s(e.formatNumber(e.statistics.overview.totalCustomers)),r(7),s(e.formatNumber(e.statistics.overview.openLeads)),r(7),s(e.formatNumber(e.statistics.overview.openTasks)),r(7),s(e.formatNumber(e.statistics.overview.activeCustomers)),r(7),s(e.formatNumber(e.statistics.overview.potentialCustomers)),r(7),s(e.formatNumber(e.statistics.overview.inactiveCustomers)),r(11),s(e.formatCurrency(e.statistics.revenue.totalRevenue)),r(7),s(e.formatCurrency(e.statistics.revenue.monthlyRevenue)),r(7),s(e.formatNumber(e.statistics.revenue.wonLeads)),r(7),s(e.formatNumber(e.statistics.revenue.lostLeads)),r(7),s(e.formatPercentage(e.statistics.revenue.conversionRate)),r(7),s(e.formatCurrency(e.statistics.revenue.wonRevenue)),r(7),c("ngForOf",e.statistics.revenue.monthlyRevenueData),r(9),s(e.formatPercentage(e.statistics.conversion.leadToCustomerRate)),r(7),s(e.formatPercentage(e.statistics.conversion.offerToWonRate)),r(7),s(e.formatPercentage(e.statistics.conversion.overallConversionRate)),r(7),c("ngForOf",e.getConversionSources()),r(5),c("ngForOf",e.getConversionStatuses())}}var Q=(()=>{class a{constructor(e){this.statisticsService=e,this.statistics=null,this.loading=!1,this.error=null}ngOnInit(){this.loadStatistics()}loadStatistics(){this.loading=!0,this.error=null,this.statisticsService.getStatistics().pipe(f(e=>(console.error("Fehler beim Laden der Statistiken:",e),this.error="Fehler beim Laden der Statistiken. Bitte versuchen Sie es erneut.",u(null))),p(()=>this.loading=!1)).subscribe(e=>{e&&(this.statistics=e)})}formatNumber(e){return this.statisticsService.formatNumber(e)}formatCurrency(e){return this.statisticsService.formatCurrency(e)}formatPercentage(e){return this.statisticsService.formatPercentage(e)}formatMonth(e){let[o,m]=e.split("-");return new Date(parseInt(o),parseInt(m)-1).toLocaleDateString("de-DE",{month:"long",year:"numeric"})}getConversionSources(){return this.statistics?.conversion.conversionBySource?Object.entries(this.statistics.conversion.conversionBySource).map(([e,o])=>({name:e,rate:o})).sort((e,o)=>o.rate-e.rate):[]}getConversionStatuses(){return this.statistics?.conversion.conversionByStatus?Object.entries(this.statistics.conversion.conversionByStatus).map(([e,o])=>({name:e,rate:o})).sort((e,o)=>o.rate-e.rate):[]}static{this.\u0275fac=function(o){return new(o||a)(b(k))}}static{this.\u0275cmp=S({type:a,selectors:[["app-statistics"]],standalone:!0,features:[O],decls:10,vars:3,consts:[[1,"statistics-container"],[1,"statistics-header"],[1,"statistics-main"],["class","loading-container",4,"ngIf"],["class","alert alert-danger","role","alert",4,"ngIf"],["class","statistics-content",4,"ngIf"],[1,"loading-container"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-3"],["role","alert",1,"alert","alert-danger"],[1,"alert-heading"],[1,"btn","btn-outline-danger",3,"click"],[1,"statistics-content"],[1,"overview-section"],[1,"stats-grid"],[1,"stat-card"],[1,"stat-value"],[1,"stat-description"],[1,"revenue-section"],[1,"revenue-grid"],[1,"revenue-card"],[1,"stat-value","text-success"],[1,"stat-value","text-danger"],[1,"monthly-revenue-section"],[1,"monthly-revenue-grid"],["class","month-card",4,"ngFor","ngForOf"],[1,"conversion-section"],[1,"conversion-grid"],[1,"conversion-card"],[1,"conversion-details"],[1,"conversion-source-grid"],["class","source-card",4,"ngFor","ngForOf"],[1,"conversion-status-grid"],["class","status-card",4,"ngFor","ngForOf"],[1,"month-card"],[1,"month-revenue"],[1,"month-leads"],[1,"text-success"],[1,"text-danger"],[1,"source-card"],[1,"source-rate"],[1,"status-card"],[1,"status-rate"]],template:function(o,m){o&1&&(t(0,"div",0)(1,"header",1)(2,"h1"),i(3,"CRM Statistiken"),n(),t(4,"p"),i(5,"Administrator-Bereich"),n()(),t(6,"main",2),v(7,R,6,0,"div",3)(8,N,7,1,"div",4)(9,T,133,18,"div",5),n()()),o&2&&(r(7),c("ngIf",m.loading),r(),c("ngIf",m.error),r(),c("ngIf",!m.loading&&!m.error&&m.statistics))},dependencies:[I,M,w],styles:[".statistics-container[_ngcontent-%COMP%]{min-height:100vh;background:#f8fafc}.statistics-header[_ngcontent-%COMP%]{background:#fff;border-bottom:1px solid #e2e8f0;padding:2rem 0;text-align:center}.statistics-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 .5rem;color:#1e293b;font-size:2rem;font-weight:600}.statistics-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#64748b;font-size:1rem}.statistics-main[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:2rem}.loading-container[_ngcontent-%COMP%]{text-align:center;padding:3rem}.statistics-content[_ngcontent-%COMP%]   section[_ngcontent-%COMP%]{margin-bottom:3rem}.statistics-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#1e293b;font-size:1.5rem;font-weight:600;margin-bottom:1.5rem;border-bottom:2px solid #e2e8f0;padding-bottom:.5rem}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1.5rem;margin-bottom:2rem}.stat-card[_ngcontent-%COMP%]{background:#fff;border-radius:.5rem;padding:1.5rem;box-shadow:0 1px 3px #0000001a;text-align:center;transition:transform .2s ease}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 6px #0000001a}.stat-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1rem;color:#64748b;font-size:.875rem;font-weight:500;text-transform:uppercase;letter-spacing:.05em}.stat-value[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:700;color:#1e293b;margin-bottom:.5rem}.stat-description[_ngcontent-%COMP%]{color:#64748b;font-size:.875rem}.revenue-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1.5rem;margin-bottom:2rem}.revenue-card[_ngcontent-%COMP%]{background:#fff;border-radius:.5rem;padding:1.5rem;box-shadow:0 1px 3px #0000001a;text-align:center}.monthly-revenue-section[_ngcontent-%COMP%]{background:#fff;border-radius:.5rem;padding:2rem;box-shadow:0 1px 3px #0000001a}.monthly-revenue-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1.5rem;color:#1e293b;font-size:1.25rem;font-weight:600}.monthly-revenue-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:1rem}.month-card[_ngcontent-%COMP%]{background:#f8fafc;border-radius:.5rem;padding:1rem;text-align:center}.month-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .5rem;color:#64748b;font-size:.875rem;font-weight:500}.month-revenue[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;color:#1e293b;margin-bottom:.5rem}.month-leads[_ngcontent-%COMP%]{font-size:.875rem}.conversion-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1.5rem;margin-bottom:2rem}.conversion-card[_ngcontent-%COMP%]{background:#fff;border-radius:.5rem;padding:1.5rem;box-shadow:0 1px 3px #0000001a;text-align:center}.conversion-details[_ngcontent-%COMP%]{background:#fff;border-radius:.5rem;padding:2rem;box-shadow:0 1px 3px #0000001a;margin-bottom:2rem}.conversion-details[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1.5rem;color:#1e293b;font-size:1.25rem;font-weight:600}.conversion-source-grid[_ngcontent-%COMP%], .conversion-status-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem}.source-card[_ngcontent-%COMP%], .status-card[_ngcontent-%COMP%]{background:#f8fafc;border-radius:.5rem;padding:1rem;text-align:center}.source-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .status-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .5rem;color:#64748b;font-size:.875rem;font-weight:500}.source-rate[_ngcontent-%COMP%], .status-rate[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;color:#1e293b}.text-success[_ngcontent-%COMP%]{color:#10b981!important}.text-danger[_ngcontent-%COMP%]{color:#ef4444!important}@media (max-width: 768px){.statistics-main[_ngcontent-%COMP%]{padding:1rem}.stats-grid[_ngcontent-%COMP%], .revenue-grid[_ngcontent-%COMP%], .conversion-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.monthly-revenue-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.statistics-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem}.stat-value[_ngcontent-%COMP%]{font-size:2rem}}"]})}}return a})();export{Q as StatisticsComponent};
